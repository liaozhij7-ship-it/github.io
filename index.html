<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>打修狗</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 配置Tailwind自定义颜色和字体 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#EC4899',
                        neutral: '#1F2937',
                        success: '#10B981',
                        danger: '#EF4444',
                    },
                    fontFamily: {
                        game: ['"Comic Sans MS"', '"Marker Felt"', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .tool-shadow {
                filter: drop-shadow(0 4px 3px rgb(0 0 0 / 0.1)) drop-shadow(0 2px 2px rgb(0 0 0 / 0.08));
            }
            .paw-bounce {
                animation: pawBounce 2s infinite;
            }
            .score-popup {
                animation: scorePopup 1s forwards;
            }
            .dog-bounce {
                animation: dogBounce 3s infinite ease-in-out;
            }
            .float {
                animation: float 3s ease-in-out infinite;
            }
            .heart-animation {
                animation: heartFloat 1.5s forwards;
                position: absolute;
                pointer-events: none;
                opacity: 0;
            }
            .dog-shrink {
                animation: dogShrink 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            }
        }
        
        @keyframes pawBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes scorePopup {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-50px); }
        }
        
        @keyframes dogBounce {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(2deg); }
            75% { transform: translateY(-10px) rotate(-2deg); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        @keyframes heartFloat {
            0% { 
                opacity: 1; 
                transform: translateY(0) scale(0.5);
            }
            100% { 
                opacity: 0; 
                transform: translateY(-60px) scale(1.2);
            }
        }
        
        /* 小狗缩小动画 */
        @keyframes dogShrink {
            0% { 
                transform: translate(-50%, -50%) scale(1) rotate(0deg);
                filter: brightness(1);
            }
            30% { 
                transform: translate(-50%, -50%) scale(0.7) rotate(-5deg);
                filter: brightness(0.9);
            }
            100% { 
                transform: translate(-50%, -50%) scale(var(--final-scale, 0.8)) rotate(0deg);
                filter: brightness(1);
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 to-orange-100 min-h-screen font-game text-neutral flex flex-col items-center justify-between p-4 md:p-8">
    <!-- 游戏标题 -->
    <header class="w-full max-w-3xl text-center mb-4 md:mb-8">
        <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold text-primary drop-shadow-lg">
            打修狗
        </h1>
    </header>
    
    <!-- 分数显示 -->
    <div class="bg-white/80 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg mb-6 border border-gray-200 z-10">
        <span class="text-gray-600 mr-2">当前分数:</span>
        <span id="score" class="text-2xl font-bold text-primary">0</span>
    </div>
    
    <!-- 游戏主区域 -->
    <main class="relative w-full max-w-2xl aspect-square bg-white rounded-2xl shadow-xl overflow-hidden border-4 border-primary/20 mb-8">
        <!-- 卧室背景图案 -->
        <div class="absolute inset-0">
            <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/code_assistant/5182356935514636aa0ebe513d8edc13~tplv-a9rns2rl98-image.image?rcl=2025082818444578C201F5543BBE664092&amp;rk3s=8e244e95&amp;rrcfp=2609e108&amp;x-expires=1756982689&amp;x-signature=4DnVJKH46A47nR%2FwxmXqfXV%2Fqug%3D" alt="卧室背景" class="w-full h-full object-cover opacity-90">
            <div class="absolute inset-0 bg-black/10"></div>
        </div>
        
        <!-- 爱心容器 -->
        <div id="heartsContainer" class="absolute inset-0 pointer-events-none z-20"></div>
        
        <!-- 小狗图像 -->
        <div id="dog" class="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 dog-bounce cursor-pointer transition-all duration-300 z-10" style="--current-scale: 1;">
            <img src="https://p3-search.byteimg.com/obj/tos-cn-i-qvj2lq49k0/4db7c80c9bab471ab8c4054f6e9c325b" alt="可爱的小狗" class="w-32 h-32 md:w-48 md:h-48 object-contain rounded-full">
        </div>
        
        <!-- 工具选择按钮 -->
        <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-4 bg-white/90 backdrop-blur-sm rounded-full px-4 py-2 shadow-lg border border-gray-200 z-20">
            <button id="hammerTool" class="tool-btn p-3 rounded-full bg-primary/10 flex items-center justify-center transition-all duration-300 hover:scale-110 active:scale-95">
                <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/code_assistant/34132f33295946c2983e7cb0d6da6f92~tplv-a9rns2rl98-image.image?rcl=20250828184527079B5C47B3CCA55CD4A7&amp;rk3s=8e244e95&amp;rrcfp=2609e108&amp;x-expires=1756982730&amp;x-signature=AcGSPasFWdm9c5okivDTjxupy4E%3D" alt="卡通锤子" class="w-8 h-8 md:w-10 md:h-10 object-contain">
            </button>
            
            <button id="handTool" class="tool-btn p-3 rounded-full bg-white flex items-center justify-center transition-all duration-300 hover:scale-110 active:scale-95">
                <i class="fa fa-hand-paper-o text-2xl md:text-3xl text-success paw-bounce"></i>
            </button>
        </div>
        
        <!-- 移动的工具图标 -->
        <div id="movingTool" class="absolute pointer-events-none opacity-0 transition-opacity duration-300 z-30">
            <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/code_assistant/34132f33295946c2983e7cb0d6da6f92~tplv-a9rns2rl98-image.image?rcl=20250828184527079B5C47B3CCA55CD4A7&amp;rk3s=8e244e95&amp;rrcfp=2609e108&amp;x-expires=1756982730&amp;x-signature=AcGSPasFWdm9c5okivDTjxupy4E%3D" alt="卡通锤子工具" class="w-12 h-12 md:w-16 md:h-16 object-contain tool-shadow">
        </div>
        
        <!-- 分数弹出提示 -->
        <div id="scorePopup" class="absolute pointer-events-none opacity-0 text-2xl font-bold z-40"></div>
    </main>
    
    <footer class="w-full max-w-2xl bg-white/70 backdrop-blur-sm rounded-xl p-4 shadow-md text-center">
        <p class="text-gray-600">
            选择下方工具后，移动到小狗身上点击或触摸<br>
            <span class="text-danger"><i class="fa fa-hammer"></i> 锤子: 扣10分，小狗会持续变小</span> | 
            <span class="text-success"><i class="fa fa-hand-paper-o"></i> 手掌: 加1分，会出现爱心</span>
        </p>
    </footer>
    
    <script>
        // 游戏状态变量
        const gameState = {
            currentTool: 'hammer',
            score: 0,
            dogScale: 1, // 跟踪小狗当前的缩放比例
            minScale: 0.4, // 小狗最小缩放比例限制
            // 存储锤子图像URL，确保所有地方使用相同的图像
            hammerImageUrl: 'https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/code_assistant/34132f33295946c2983e7cb0d6da6f92~tplv-a9rns2rl98-image.image?rcl=20250828184527079B5C47B3CCA55CD4A7&amp;rk3s=8e244e95&amp;rrcfp=2609e108&amp;x-expires=1756982730&amp;x-signature=AcGSPasFWdm9c5okivDTjxupy4E%3D'
        };
        
        // DOM元素
        const dogElement = document.getElementById('dog');
        const scoreElement = document.getElementById('score');
        const scorePopup = document.getElementById('scorePopup');
        const hammerTool = document.getElementById('hammerTool');
        const handTool = document.getElementById('handTool');
        const movingTool = document.getElementById('movingTool');
        const gameArea = document.querySelector('main');
        const heartsContainer = document.getElementById('heartsContainer');
        
        // 更新分数显示
        function updateScore(points) {
            gameState.score += points;
            scoreElement.textContent = gameState.score;
            showScorePopup(points);
        }
        
        // 显示分数弹出动画
        function showScorePopup(points) {
            const sign = points > 0 ? '+' : '';
            const color = points > 0 ? 'text-success' : 'text-danger';
            
            scorePopup.textContent = `${sign}${points}`;
            scorePopup.className = `absolute pointer-events-none text-2xl font-bold ${color} score-popup`;
            
            const dogRect = dogElement.getBoundingClientRect();
            const gameRect = gameArea.getBoundingClientRect();
            
            scorePopup.style.left = `${dogRect.left - gameRect.left + dogRect.width/2}px`;
            scorePopup.style.top = `${dogRect.top - gameRect.top - 30}px`;
            scorePopup.style.transform = 'translate(-50%, 0)';
            
            // 重置动画
            scorePopup.style.animation = 'none';
            scorePopup.offsetHeight;
            scorePopup.style.animation = 'scorePopup 1s forwards';
        }
        
        // 创建爱心动画
        function createHearts() {
            heartsContainer.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const heart = document.createElement('div');
                heart.innerHTML = '<i class="fa fa-heart text-secondary text-2xl md:text-3xl"></i>';
                heart.className = 'heart-animation';
                
                const dogRect = dogElement.getBoundingClientRect();
                const gameRect = gameArea.getBoundingClientRect();
                const centerX = dogRect.left - gameRect.left + dogRect.width/2;
                const centerY = dogRect.top - gameRect.top + dogRect.height/2;
                
                const offsetX = (Math.random() - 0.5) * 60;
                const offsetY = (Math.random() - 0.5) * 40;
                
                heart.style.left = `${centerX + offsetX}px`;
                heart.style.top = `${centerY + offsetY}px`;
                heart.style.animationDelay = `${i * 0.15}s`;
                
                heartsContainer.appendChild(heart);
            }
            
            setTimeout(() => {
                heartsContainer.innerHTML = '';
            }, 1500);
        }
        
        // 切换工具
        function switchTool(tool) {
            gameState.currentTool = tool;
            
            if (tool === 'hammer') {
                hammerTool.classList.add('bg-primary/10');
                hammerTool.classList.remove('bg-white');
                handTool.classList.add('bg-white');
                handTool.classList.remove('bg-primary/10');
                // 使用统一的锤子图像URL
                movingTool.innerHTML = `<img src="${gameState.hammerImageUrl}" alt="卡通锤子工具" class="w-12 h-12 md:w-16 md:h-16 object-contain tool-shadow">`;
            } else {
                handTool.classList.add('bg-primary/10');
                handTool.classList.remove('bg-white');
                hammerTool.classList.add('bg-white');
                hammerTool.classList.remove('bg-primary/10');
                movingTool.innerHTML = '<i class="fa fa-hand-paper-o text-4xl md:text-5xl text-success tool-shadow"></i>';
            }
        }
        
        // 处理小狗点击
        function handleDogInteraction() {
            if (gameState.currentTool === 'hammer') {
                // 锤子：扣分，小狗持续变小
                updateScore(-10);
                
                // 计算新的缩放比例，不小于最小限制
                gameState.dogScale = Math.max(gameState.dogScale * 0.85, gameState.minScale);
                
                // 设置动画和最终缩放比例
                dogElement.style.setProperty('--final-scale', gameState.dogScale);
                
                // 移除并重新添加动画类以重置动画
                dogElement.classList.remove('dog-shrink');
                void dogElement.offsetWidth; // 触发重绘
                dogElement.classList.add('dog-shrink');
                
                // 应用新的缩放比例
                setTimeout(() => {
                    dogElement.style.transform = `translate(-50%, -50%) scale(${gameState.dogScale})`;
                }, 500);
                
                // 锤子击打动画 - 使用相同的锤子图像
                movingTool.classList.add('scale-125', 'rotate-12');
                setTimeout(() => {
                    movingTool.classList.remove('scale-125', 'rotate-12');
                }, 150);
            } else {
                // 手掌：加分（改为加1分），散发爱心，小狗略微变大
                updateScore(1);  // 这里从10分改为1分
                createHearts();
                
                // 抚摸时让小狗略微变大（调整幅度，因为得分降低了）
                gameState.dogScale = Math.min(gameState.dogScale * 1.03, 1.2);  // 调整了放大比例
                dogElement.style.transform = `translate(-50%, -50%) scale(${gameState.dogScale})`;
                
                // 小狗被抚摸的动画
                dogElement.classList.add('scale-105', 'rotate-0');  // 调整了动画幅度
                setTimeout(() => {
                    dogElement.classList.remove('scale-105', 'rotate-0');
                }, 200);
                
                // 手掌抚摸动画
                movingTool.classList.add('scale-105');  // 调整了动画幅度
                setTimeout(() => {
                    movingTool.classList.remove('scale-105');
                }, 150);
            }
        }
        
        // 移动工具图标
        function moveTool(x, y) {
            movingTool.style.left = `${x}px`;
            movingTool.style.top = `${y}px`;
            movingTool.style.transform = 'translate(-50%, -50%)';
            movingTool.classList.add('opacity-100');
            movingTool.classList.remove('opacity-0');
        }
        
        // 隐藏工具图标
        function hideTool() {
            movingTool.classList.remove('opacity-100');
            movingTool.classList.add('opacity-0');
        }
        
        // 事件监听
        hammerTool.addEventListener('click', () => switchTool('hammer'));
        handTool.addEventListener('click', () => switchTool('hand'));
        
        gameArea.addEventListener('mousemove', (e) => {
            const rect = gameArea.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            moveTool(x, y);
        });
        
        gameArea.addEventListener('mouseleave', hideTool);
        
        gameArea.addEventListener('click', (e) => {
            const dogRect = dogElement.getBoundingClientRect();
            const clickX = e.clientX;
            const clickY = e.clientY;
            
            if (clickX >= dogRect.left && clickX <= dogRect.right &&
                clickY >= dogRect.top && clickY <= dogRect.bottom) {
                handleDogInteraction();
            }
        });
        
        // 触摸设备支持
        gameArea.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const rect = gameArea.getBoundingClientRect();
            const x = e.touches[0].clientX - rect.left;
            const y = e.touches[0].clientY - rect.top;
            moveTool(x, y);
        }, { passive: false });
        
        gameArea.addEventListener('touchend', hideTool);
        
        gameArea.addEventListener('touchstart', (e) => {
            const rect = gameArea.getBoundingClientRect();
            const touchX = e.touches[0].clientX;
            const touchY = e.touches[0].clientY;
            
            const dogRect = dogElement.getBoundingClientRect();
            if (touchX >= dogRect.left && touchX <= dogRect.right &&
                touchY >= dogRect.top && touchY <= dogRect.bottom) {
                handleDogInteraction();
            }
        });
        
        // 初始化
        switchTool('hammer');
    </script>


    </body></html>
